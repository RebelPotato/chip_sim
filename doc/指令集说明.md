# 指令说明

**注意：下面的原语功能、字段定义仅供参考，可以根据需要自己更改**

## 0. Stop

* 功能：功能核停止运行，PC（Program Counter）清零
* 标识码：0000
* 字段含义
  * 无字段

## 1. Jump

* 功能
  * 使PC跳转到某个绝对地址（即下一条指令从SRAM的某个绝对地址取数）
  * 使PC在当前地址基础上进行固定偏移量的跳转
* 标识：0001
* 字段含义
  * jump_addr：绝对地址模式为无符号数，代表绝对地址；相对地址模式时为有符号数，代表地址偏移量
  * relative_mode：0代表绝对地址模式，1代表相对地址模式

## 2. Store

* 功能：将SRAM的数据搬运到DRAM
* 标识：0010
* 字段含义
  * sram_addr：数据在SRAM上的初始存放地址
  * data_length：数据长度，即对数据按照128bit为单位计数时的总个数
  * dram_addr：数据在DRAM上的目标存放地址

## 3. Load

* 功能：将DRAM的数据搬运到SRAM
* 标识：0011
* 字段含义
  * sram_addr：数据在SRAM上的目标存放地址
  * data_length：数据长度，即对数据按照128bit为单位计数时的总个数
  * dram_addr：数据在DRAM上的初始存放地址

## 4. ReLU

* 功能：对一系列连续的数值进行`ReLU`操作，对于每个输入数`x`，输出为`(x > threshold) ? x : threshold`
* 标识：0100
* 字段含义
  * input_addr：输入数据的基地址
  * data_length：数据长度，即对数据按照128bit为单位计数时的总个数；
  * threshold：阈值，所有数统一
  * output_addr：输出数据基地址
  * float_mode：1代表处理的数据为BF16类型（即每个数为16bit浮点数，每128bits中有8个数）
    * 代码中仅实现BF16的情况

## 5. LIF

* 功能：对`n`个神经元，在`T`个时间步计算LIF模型。每个时间步中，每个神经元都会一个输入（即所有突触加权求和的结果），将每个时间步的结果依次累加到膜电位，并进行发放/衰减。
* 标识：0101
* 字段含义
  * input_addr：输入数据基地址
  * neuron_num：神经元个数（按照16Byte计数）
  * time_step：时间步个数（输入的总数据量应为`neuron_num * time_step` ）
  * threshold：发放阈值，所有神经元统一
  * decay：衰减系数，无发放情况下每个神经元每个时间步膜电位都要乘上这个系数
  * potential_addr：膜电位基地址
  * output_addr：输出数据基地址，输出数据应该也有时间步和神经元两个维度
* 存储：按照`数据存储方式说明.pdf`，推荐的维度顺序为 `(time_step, neuron_num)`，可根据需求自己调整

## 6. MatrixMultiply

功能、标识见excel文档
字段含义符合一般矩阵乘含义，略
* 存储：按照`数据存储方式说明.pdf`，可根据需求自己调整，尽量保证输入和输出的矩阵存储维度顺序相同（否则无法连续进行多层计算）

## 7. Conv
功能、标识见excel文档
字段含义符合一般矩阵乘含义，略
* 存储：按照`数据存储方式说明.pdf`，推荐输入输出特征图使用`(Height, Width, Channel)`顺序存储，权重使用`(Height, Width, C_in, C_out)`顺序存储，可根据需求自己调整，尽量保证输入和输出的张量存储维度顺序相同（否则无法连续进行多层计算）。